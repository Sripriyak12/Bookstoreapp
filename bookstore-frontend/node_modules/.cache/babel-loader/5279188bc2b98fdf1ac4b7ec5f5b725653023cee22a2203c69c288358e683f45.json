{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Cart(){const[cart,setCart]=useState([]);const[total,setTotal]=useState(0);const userId=localStorage.getItem(\"userId\");// ðŸ‘ˆ pulls from login storage\nuseEffect(()=>{if(!userId)return;axios.get(\"/api/cart/\".concat(userId)).then(res=>{setCart(res.data);const sum=res.data.reduce((acc,item)=>acc+item.book.price*item.quantity,0);setTotal(sum);}).catch(err=>{console.error(\"Failed to load cart:\",err);alert(\"Could not load cart. Please try again.\");});},[userId]);const removeFromCart=id=>{axios.delete(\"/api/cart/remove/\".concat(id)).then(()=>{setCart(prev=>prev.filter(item=>item.id!==id));});};const handleCheckout=async()=>{try{const response=await axios.post('/api/orders/place',null,{params:{userId:userId,totalAmount:total.toFixed(2)}});alert(\"ðŸŽ‰ Order placed successfully!\");setCart([]);setTotal(0);}catch(error){console.error(\"Checkout failed:\",error);alert(\"Failed to place order.\");}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Cart\"}),cart.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"strong\",{children:item.book.title}),\" x \",item.quantity,\" = \\u20B9\",(item.book.price*item.quantity).toFixed(2),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-danger ms-2\",onClick:()=>removeFromCart(item.id),children:\"Remove\"})]},item.id)),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Total: \\u20B9\",total.toFixed(2)]}),cart.length>0&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mt-3\",onClick:handleCheckout,children:\"\\u2705 Proceed to Checkout\"})]});}export default Cart;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Cart","cart","setCart","total","setTotal","userId","localStorage","getItem","get","concat","then","res","data","sum","reduce","acc","item","book","price","quantity","catch","err","console","error","alert","removeFromCart","id","delete","prev","filter","handleCheckout","response","post","params","totalAmount","toFixed","children","map","className","title","onClick","length"],"sources":["C:/Users/sri/Downloads/bookstore-fullstack/bookstore-frontend/src/components/Cart.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nfunction Cart() {\r\n  const [cart, setCart] = useState([]);\r\n  const [total, setTotal] = useState(0);\r\n  const userId = localStorage.getItem(\"userId\"); // ðŸ‘ˆ pulls from login storage\r\n\r\n  useEffect(() => {\r\n    if (!userId) return;\r\n\r\n    axios.get(`/api/cart/${userId}`)\r\n      .then(res => {\r\n        setCart(res.data);\r\n        const sum = res.data.reduce((acc, item) => acc + item.book.price * item.quantity, 0);\r\n        setTotal(sum);\r\n      })\r\n      .catch(err => {\r\n        console.error(\"Failed to load cart:\", err);\r\n        alert(\"Could not load cart. Please try again.\");\r\n      });\r\n  }, [userId]);\r\n\r\n  const removeFromCart = (id) => {\r\n    axios.delete(`/api/cart/remove/${id}`)\r\n      .then(() => {\r\n        setCart(prev => prev.filter(item => item.id !== id));\r\n      });\r\n  };\r\n  const handleCheckout = async () => {\r\n  try {\r\n    const response = await axios.post('/api/orders/place', null, {\r\n      params: {\r\n        userId: userId,\r\n        totalAmount: total.toFixed(2)\r\n      }\r\n    });\r\n    alert(\"ðŸŽ‰ Order placed successfully!\");\r\n    setCart([]);\r\n    setTotal(0);\r\n  } catch (error) {\r\n    console.error(\"Checkout failed:\", error);\r\n    alert(\"Failed to place order.\");\r\n  }\r\n};\r\n\r\n\r\n  return (\r\n    <div>\r\n      <h2>Your Cart</h2>\r\n      {cart.map(item => (\r\n        <div key={item.id} className=\"mb-3\">\r\n          <strong>{item.book.title}</strong> x {item.quantity} = â‚¹{(item.book.price * item.quantity).toFixed(2)}\r\n          <button className=\"btn btn-sm btn-danger ms-2\" onClick={() => removeFromCart(item.id)}>Remove</button>\r\n        </div>\r\n      ))}\r\n      <h4>Total: â‚¹{total.toFixed(2)}</h4>\r\n          {cart.length > 0 && (\r\n      <button className=\"btn btn-success mt-3\" onClick={handleCheckout}>\r\n        âœ… Proceed to Checkout\r\n      </button>\r\n    )}\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Cart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}